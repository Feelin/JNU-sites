function gotoTOP(){window.scrollBy(0,-10),scrolldelay=setTimeout("gotoTOP()",10),$(document).scrollTop()==0&&clearTimeout(scrolldelay)}function showdiv(e){document.getElementById("bg").style.display="block",document.getElementById(e).style.display="block"}function hidediv(e){document.getElementById("bg").style.display="none",document.getElementById("showhobby").style.display="none",document.getElementById("showstudy").style.display="none",document.getElementById("showtool").style.display="none",document.getElementById("editwebsite").style.display="none",document.getElementById("feedback").style.display="none"}function setCookie(e,t,n){var r=new Date;r.setDate(r.getDate()+n),document.cookie=e+"="+escape(t)+(n==null?"":";expires="+r.toGMTString())}function getCookie(e){if(document.cookie.length>0){c_start=document.cookie.indexOf(e+"=");if(c_start!=-1)return c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))}return""}function SetHome(e,t){try{e.style.behavior="url(#default#homepage)",e.setHomePage(t)}catch(n){if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(n){alert("此操作被浏览器拒绝！\n请在浏览器地址栏输入“about:config”并回车\n然后将 [signed.applets.codebase_principal_support]的值设置为'true',双击即可。")}var r=Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch);r.setCharPref("browser.startup.homepage",t)}}}function getwebsite(userid){$.get("php/getwebsite.php",{jnufmid:userid},function(data){websitejson=eval("("+data+")");var html1="",html2="";lenght=websitejson.length;for(var i=0;i<lenght&&i<32;i++){var webname=websitejson[i].webname;websitejson[i].webname.length>4?(webname=websitejson[i].webname.substr(0,4)+"...",html1+='<li><a title="'+websitejson[i].webname+'" id="'+websitejson[i].position+'" class="'+websitejson[i].color+'" target="_blank" href="'+websitejson[i].weburl+'">'+webname+'</a><img class="del" src="img/delete.png"></li>'):html1+='<li><a id="'+websitejson[i].position+'" class="'+websitejson[i].color+'" target="_blank" href="'+websitejson[i].weburl+'">'+webname+'</a><img class="del" src="img/delete.png"></li>'}for(var i=32;i<lenght&&i<64;i++){var webname=websitejson[i].webname;websitejson[i].webname.length>4?(webname=websitejson[i].webname.substr(0,4)+"...",html2+='<li><a title="'+websitejson[i].webname+'" id="'+websitejson[i].position+'" class="'+websitejson[i].color+'" target="_blank" href="'+websitejson[i].weburl+'">'+webname+'</a><img class="del" src="img/delete.png"></li>'):html2+='<li><a id="'+websitejson[i].position+'" class="'+websitejson[i].color+'" target="_blank" href="'+websitejson[i].weburl+'">'+webname+'</a><img class="del" src="img/delete.png"></li>'}$("#chooseLink1").html(html1),$("#chooseLink2").html(html2)})}function getweather(userid){$.get("php/getweather.php",{jnufmid:userid},function(data){var weatherjson=eval("(["+data+"])"),htm1="",htm2="";htm1+='<img style="width: 50px; height: 50px" src="img/weatherimg/'+weatherjson[0].img1+'">'+weatherjson[0].temp1+'<br/><span class="weathertext">今：'+weatherjson[0].weather1+"</span>",htm2+='<img style="width: 50px; height: 50px" src="img/weatherimg/'+weatherjson[0].img3+'">'+weatherjson[0].temp2+'<br/><span class="weathertext">明：'+weatherjson[0].weather2+"</span>",datetime=weatherjson[0].date+"<br/>"+weatherjson[0].week+"&nbsp;"+weatherjson[0].city+"&nbsp;<a href='javascript:;' id='resetcity'>[切换]</a>",$(".todayweather").html(htm1),$(".tomoweather").html(htm2),$(".time").html(datetime),$("#resetcity").click(function(){setCookie("myid",getCookie("JnuFm"),365),delCookie("JnuFm"),location.reload()})})}function getPropertyCount(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}function getfixed(cookie){$.get("php/getfixed.php",{jnufmid:cookie},function(data){var fixedjson=eval("(["+data+"])"),majorhtml="",hobbyhtml="",toolhtml="",majorlen=getPropertyCount(fixedjson[0].major),hobbylen=getPropertyCount(fixedjson[0].hobby),toollen=getPropertyCount(fixedjson[0].tool);for(var i=0;i<majorlen;i++){var webname=fixedjson[0].major[i].webname;webname.length>4?(webname=fixedjson[0].major[i].webname.substr(0,4)+"...",majorhtml+="<li><a title='"+fixedjson[0].major[i].webname+"' href='"+fixedjson[0].major[i].weburl+"' target='_blank'>"+webname+"</a></li>"):majorhtml+="<li><a href='"+fixedjson[0].major[i].weburl+"' target='_blank'>"+fixedjson[0].major[i].webname+"</a></li>"}for(var i=0;i<hobbylen;i++){var webname=fixedjson[0].hobby[i].webname;webname.length>4?(webname=webname.substr(0,4)+"...",hobbyhtml+="<li><a title='"+fixedjson[0].hobby[i].webname+"' href='"+fixedjson[0].hobby[i].weburl+"' target='_blank'>"+webname+"</a></li>"):hobbyhtml+="<li><a href='"+fixedjson[0].hobby[i].weburl+"' target='_blank'>"+fixedjson[0].hobby[i].webname+"</a></li>"}for(var i=0;i<toollen;i++){var webname=fixedjson[0].tool[i].webname;webname.length>4?(webname=fixedjson[0].tool[i].webname.substr(0,4)+"...",toolhtml+="<li><a title='"+fixedjson[0].tool[i].webname+"' href='"+fixedjson[0].tool[i].weburl+"' target='_blank'>"+webname+"</a></li>"):toolhtml+="<li><a href='"+fixedjson[0].tool[i].weburl+"' target='_blank'>"+fixedjson[0].tool[i].webname+"</a></li>"}$("#majorcontent").html(majorhtml),$("#hobbycontent").html(hobbyhtml),$("#toolcontent").html(toolhtml),pager("majorcontent","majorpager",21),pager("hobbycontent","hobbypager",21)})}function getcheckinfo(typename){$.get("php/getcheckinfo.php",{uid:getCookie("JnuFm"),typename:typename},function(data){var checkinfojson=eval("(["+data+"])"),checkinfohtml="",checkinfolen=getPropertyCount(checkinfojson[0]);for(var i=0;i<checkinfolen;i++)checkinfojson[0][i].ifchecked=="checked"?checkinfohtml+='<label class="checklabel"><img src="img/'+typename+'/checked.png"><input type="checkbox" checked="checked" name="checkwhich[]" class="'+typename+'" value="/'+checkinfojson[0][i].checkname+'">'+checkinfojson[0][i].checkname+"</label>":checkinfohtml+='<label class="checklabel"><img src="img/unchecked.png"><input type="checkbox" name="checkwhich[]" class="'+typename+'" value="/'+checkinfojson[0][i].checkname+'">'+checkinfojson[0][i].checkname+"</label>";checkinfohtml+=' <input type="hidden" name="jnufmid" value="'+getCookie("JnuFm")+'" class="uid"><input type="hidden" name="fixedtype" value="'+typename+'">',$("."+typename+"list").html(checkinfohtml),$(".checklabel").hover(function(){if($(this).children("input").attr("checked")!="checked"){var e=$(this).children("input").attr("class");$(this).children("img").attr("src","img/"+e+"/hovering.png")}},function(){if($(this).children("input").attr("checked")!="checked")$(this).children("img").attr("src","img/unchecked.png");else{var e=$(this).children("input").attr("class");$(this).children("img").attr("src","img/"+e+"/checked.png")}}),$(".checklabel").click(function(){if($(this).children("input").attr("checked")=="checked"){var e=$(this).children("input").attr("class");$(this).children("img").attr("src","img/"+e+"/checked.png")}else $(this).children("img").attr("src","img/unchecked.png")})})}function pager(e,t,n){var r=$("#"+e).children("li").length,i=Math.ceil(r/n);i<=0&&(i=1);var s=$("#"+t).children(".nowpage").text(),o=1;$("#"+e).children("li").each(function(){o<(s-1)*n+1||o>s*n?$(this).css("display","none"):$(this).css({display:"inline-block","float":"left"}),o++}),$("#"+t).children(".pagenum").text(i)}function delCookie(e){var t=new Date;t.setTime(t.getTime()-1e4),document.cookie=e+"=a; expires="+t.toGMTString()}$(document).ready(function(){if(getCookie("myid"))r=getCookie("myid"),website=r;else{var e=new Date,r=e.getTime();website="common"}setInterval(function(){$(".yun1").animate({left:"-=4"},80)},20),setInterval(function(){$(".yun2").animate({left:"-=2"},105)},20),$(".zhuhai,.enter2").click(function(){$(".zhuhai").unbind(),clearTimeout(v),$(".zhuhai .layer").hide(),$(".enter2").hide(),$(".benbu").fadeOut("fast"),$(".shenlv").fadeOut("fast"),$(".huawen").fadeOut("fast"),$(".t_huawen").fadeOut("fast"),$(".t_zhuhai").fadeOut("fast"),$(".t_shenlv").fadeOut("fast"),$(".t_benbu").fadeOut("fast"),$(".header").animate({opacity:0},500,function(){$(".zhuhai").animate({left:270},500,function(){$(".container").animate({top:-1e3},1e3)})}),setCookie("JnuFm",r,365),delCookie("myid"),$.get("php/addnewuser.php",{newid:r,city:"zh"}),getweather(r),$(".uid").val(r),getwebsite(website),getfixed(r)}),$(".benbu,.enter1").click(function(){$(".benbu").unbind(),clearTimeout(t),$(".benbu .layer").hide(),$(".enter1").hide(),$(".zhuhai").fadeOut("fast"),$(".shenlv").fadeOut("fast"),$(".huawen").fadeOut("fast"),$(".t_huawen").fadeOut("fast"),$(".t_zhuhai").fadeOut("fast"),$(".t_shenlv").fadeOut("fast"),$(".t_benbu").fadeOut("fast"),$(".header").animate({opacity:0},500,function(){$(".benbu").animate({left:270},1e3,function(){$(".container").animate({top:-1e3},1e3)})}),setCookie("JnuFm",r,365),delCookie("myid"),$.get("php/addnewuser.php",{newid:r,city:"gz"}),getweather(r),$(".uid").val(r),getwebsite(website),getfixed(r)}),$(".shenlv,.enter3").click(function(){$(".shenlv").unbind(),clearTimeout(m),$(".shenlv .layer").hide(),$(".enter3").hide(),$(".benbu").fadeOut("fast"),$(".zhuhai").fadeOut("fast"),$(".huawen").fadeOut("fast"),$(".t_huawen").fadeOut("fast"),$(".t_zhuhai").fadeOut("fast"),$(".t_shenlv").fadeOut("fast"),$(".t_benbu").fadeOut("fast"),$(".header").animate({opacity:0},500,function(){$(".shenlv").animate({left:270},500,function(){$(".container").animate({top:-1e3},1e3)})}),setCookie("JnuFm",r,365),delCookie("myid"),$.get("php/addnewuser.php",{newid:r,city:"sz"}),getweather(r),$(".uid").val(r),getwebsite(website),getfixed(r)}),$(".huawen,.enter4").click(function(){$(".huawen").unbind(),clearTimeout(n),$(".huawen .layer").hide(),$(".enter4").hide(),$(".benbu").fadeOut("fast"),$(".shenlv").fadeOut("fast"),$(".zhuhai").fadeOut("fast"),$(".t_huawen").fadeOut("fast"),$(".t_zhuhai").fadeOut("fast"),$(".t_shenlv").fadeOut("fast"),$(".t_benbu").fadeOut("fast"),$(".header").animate({opacity:0},500,function(){$(".huawen").animate({left:270},1e3,function(){$(".container").animate({top:-1e3},1e3)})}),setCookie("JnuFm",r,365),delCookie("myid"),$.get("php/addnewuser.php",{newid:r,city:"gz"}),getweather(r),$(".uid").val(r),getwebsite(website),getfixed(r)}),$(".a_benbu").mouseenter(function(){t=setTimeout(function(){$(".benbu .layer").fadeIn("fast"),$(".enter1").fadeIn("fast")},200)}),$(".a_benbu").mouseleave(function(){clearTimeout(t),$(".benbu .layer").fadeOut("fast"),$(".enter1").fadeOut("fast")}),$(".a_zhuhai").mouseenter(function(){v=setTimeout(function(){$(".zhuhai .layer").fadeIn("fast"),$(".enter2").fadeIn("fast")},200)}),$(".a_zhuhai").mouseleave(function(){clearTimeout(v),$(".zhuhai .layer").fadeOut("fast"),$(".enter2").fadeOut("fast")}),$(".a_shenlv").mouseenter(function(){m=setTimeout(function(){$(".shenlv .layer").fadeIn("fast"),$(".enter3").fadeIn("fast")},200)}),$(".a_shenlv").mouseleave(function(){clearTimeout(m),$(".shenlv .layer").fadeOut("fast"),$(".enter3").fadeOut("fast")}),$(".a_huawen").mouseenter(function(){n=setTimeout(function(){$(".huawen .layer").fadeIn("fast"),$(".enter4").fadeIn("fast")},200)}),$(".a_huawen").mouseleave(function(){clearTimeout(n),$(".huawen .layer").fadeOut("fast"),$(".enter4").fadeOut("fast")})});var TabbedPanels1=new Spry.Widget.TabbedPanels("TabbedPanels1"),aBtn=document.getElementById("searchby").getElementsByTagName("a"),oSlogo=document.getElementById("searchlogo"),arr=["baidu.png","google.png","library.png","taobao.png"],oSearchBar=document.getElementById("searchform"),oBorder=oSearchBar.getElementsByTagName("input")[0],oSubmit=oSearchBar.getElementsByTagName("input")[1],txtObj=document.getElementById("alertSpan"),logolink=document.getElementById("logolink");for(var i=0;i<aBtn.length;i++)aBtn[i].index=i,aBtn[i].onclick=function(){function t(e,t,n){oSearchBar.action=e,oBorder.name=t,logolink.href=n}oBorder.value="";for(var e=0;e<aBtn.length;e++)aBtn[e].className="",oSlogo.innerHTML="";this.className="active",oSlogo.src="img/"+arr[this.index];switch(this.index){case 0:t("http://www.baidu.com/s","wd","http://www.baidu.com"),searchtype="baidu",setCookie("type","baidu",365);break;case 1:t("http://www.google.com.hk/search","q","http://www.google.com.hk"),searchtype="google",setCookie("type","google",365);break;case 2:t("http://202.116.13.244/search*chx/?searchtype=X&","searcharg","http://libgp.jnu.edu.cn"),$("<input type='hidden' name='searchtype' value='X'>").insertBefore(oBorder),searchtype="library",setCookie("type","library",365);break;case 3:t("http://s.taobao.com/search","q","http://s.taobao.com"),searchtype="taobao",setCookie("type","taobao",365)}};$(document).ready(function(){$("#inputtext").focus(),getCookie("JnuFm")?(getwebsite(getCookie("JnuFm")),getweather(getCookie("JnuFm")),getfixed(getCookie("JnuFm")),$(".uid").val(getCookie("JnuFm"))):$(".container").css("display","block"),pager("toolcontent","toolpager",21),$("#majorlink").click(function(){getcheckinfo("major"),showdiv("showstudy")}),$("#hobbylink").click(function(){getcheckinfo("hobby"),showdiv("showhobby")}),$(".downpage").click(function(){var e=$(this).prev("span").prev("span").text(),t=$(this).prev("span").text();if(e==t)return!1;e++,$(this).prev("span").prev("span").text(e);var n=$(this).attr("name");pager(n+"content",n+"pager",21)}),$(".uppage").click(function(){var e=$(this).next("span").text();if(e==1)return!1;e--,$(this).next("span").text(e);var t=$(this).attr("name");pager(t+"content",t+"pager",21)}),$(".popradiobox").children().children().children("label").click(function(){$(".popradiobox").children().children().children("label").each(function(){$(this).children("input").attr("checked")=="checked"?(color=$(this).children("input").attr("value"),$(this).children("img").attr("src","img/webcolor/"+color+"checked.png")):(color=$(this).children("input").attr("value"),$(this).children("img").attr("src","img/webcolor/"+color+".png"))})})}),$(document).ready(function(){searchtype=getCookie("type"),$("#"+searchtype).trigger("click"),$("#inputtext").click(function(){$.get("php/search.php",{w:$("#inputtext").val(),type:searchtype},function(e){if(e!=""){var t;t=e.split(",");var n;n="<table id='a'>";for(var r=0;r<t.length;r++)n+="<tr class='line'><td class='std'>"+t[r]+"</td></tr>";n+="</table>",$("#search_result").empty(),$("#search_result").append(n),$("#a tr:first").addClass("hover"),$("#search_result").show(),$("#a tr .std").hover(function(){$("#a tr:first").removeClass("hover"),$(this).addClass("hover")},function(){$(this).removeClass("hover")})}else $("#search_result").empty(),$("#search_result").hide()})}),$("#inputtext").keyup(function(e){(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||e.keyCode>=65&&e.keyCode<=90||e.keyCode==8||e.keyCode==32)&&$.get("php/search.php",{w:$("#inputtext").val(),type:"baidu"},function(e){if(e!=""){var t;t=e.split(",");var n;n="<table id='a'>";for(var r=0;r<t.length;r++)n+="<tr class='line'><td class='std'>"+t[r]+"</td></tr>";n+="</table>",$("#search_result").empty(),$("#search_result").append(n),$("#a tr:first").addClass("hover"),$("#search_result").show(),$("#a tr .std").hover(function(){$("#a tr:first").removeClass("hover"),$(this).addClass("hover")},function(){$(this).removeClass("hover")})}else $("#search_result").empty(),$("#search_result").hide()}),$(".hover").live("click",function(){$("#inputtext").val($(this).text());var e=$(this).text(),t=getCookie("type").substring(0,1);switch(t){case"b":window.location.href="http://www.baidu.com/s?wd="+e;break;case"g":window.location.href="http://www.google.com.hk/search?q="+e;break;case"l":window.location.href="http://202.116.13.244/search*chx/?searchtype=X&searcharg="+e;break;case"t":window.location.href="http://s.taobao.com/search?q="+e}}),e.keyCode==38&&($(".hover").prev().addClass("hover"),$(".hover").next().removeClass("hover"),$("#inputtext").val($(".hover").text())),e.keyCode==40&&($("#a tr.hover").next().addClass("hover"),$("#a tr.hover").prev().removeClass("hover"),$("#inputtext").val($("#a tr.hover").text()))})}),$(document).ready(function(){$("*").click(function(){$("#search_result").empty(),$("#search_result").hide()})}),$(function(){$("#btntext").toggle(function(){$(this).text("保存设置"),$(".TabbedPanelsContent>ul>li>img").css("display","block");var e=$("<li class='addweb'>添加</li>");websitejson.length<32?$(".TabbedPanelsContent>ul:first").append(e):$(".TabbedPanelsContent>ul:last").append(e),$(".TabbedPanelsContent>ul>li").css("cursor","pointer"),$(".del").click(function(){$.get("php/delete.php",{uid:getCookie("JnuFm"),position:$(this).parent("li").children("a").attr("id")}),$(this).parent("li").remove()}),$(".TabbedPanelsContent>ul>li>a").click(function(){return $(this).attr("title")?name=$(this).attr("title"):name=$(this).text(),$("#webname").val(name),$("#webadd").val($(this).attr("href")),color=$(this).attr("class"),$("#position").val($(this).attr("id")),$("#"+color+"label").trigger("click"),$("#"+color+"label").trigger("click"),$("#do").val("update"),showdiv("editwebsite"),!1}),$(".addweb").click(function(){return showdiv("editwebsite"),index=$(".TabbedPanelsContent>ul>li>a").eq(-1).attr("id"),index++,$("#position").val(index),$("#do").val("add"),!1})},function(){$(this).text("管理网站"),$(".TabbedPanelsContent>ul>li").css("cursor","auto"),$(".TabbedPanelsContent>ul>li>img").css("display","none"),$(".addweb").remove(),getwebsite(getCookie("JnuFm"))}),$("#feedbackbtn").click(function(){$.get("php/feedback.php",{uid:getCookie("JnuFm"),content:$(".feedbacktext").val()}),hidediv()}),$("#inputsubmit").click(function(){$.get("php/searchdata.php",{uid:getCookie("JnuFm"),content:$("#inputtext").val(),searchby:getCookie("type")})})})